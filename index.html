<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Coliber ðŸŒŸ</title>
<link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;700&display=swap" rel="stylesheet">
<style>
body {
  margin:0;
  font-family:'Vazirmatn',sans-serif;
  background: linear-gradient(135deg,#0d0d20,#1e1e30);
  color:#fff;
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  height:100vh;
}
#chat {
  width:90%;
  max-width:600px;
  height:65vh;
  background: rgba(0,0,0,0.3);
  overflow:auto;
  padding:16px;
  border-radius:14px;
  margin-bottom:12px;
  box-shadow:0 8px 20px rgba(0,0,0,0.6);
}
.msg {
  margin:10px 0;
  padding:12px 14px;
  border-radius:14px;
  max-width:75%;
  line-height:1.5;
  word-break:break-word;
  opacity:0;
  transform:translateY(10px);
  transition: all .3s ease;
}
.msg.show { opacity:1; transform:translateY(0); }
.user {
  margin-left:auto;
  background: linear-gradient(90deg,#022b3a,#03506f);
  color:#e0ffff;
}
.bot {
  margin-right:auto;
  background: linear-gradient(90deg,#2b1b3f,#6835a0);
  color:#fff;
}
#inputArea {
  width:90%;
  max-width:600px;
  display:flex;
  gap:8px;
}
input[type="text"] {
  flex:1;
  padding:12px;
  border-radius:10px;
  border:none;
  background: rgba(0,0,0,0.35);
  color:#fff;
  font-size:15px;
}
button {
  padding:12px 18px;
  border-radius:10px;
  border:none;
  background:#4caf50;
  color:#fff;
  font-weight:700;
  cursor:pointer;
}
.typing { display:flex; gap:6px; align-items:center; padding:8px 12px; border-radius:12px; background: rgba(255,255,255,0.03); width:100px; }
.dot { width:8px; height:8px; background:#fff; border-radius:50%; opacity:0.35; animation: blink 1s infinite; }
.dot:nth-child(2){ animation-delay: .15s }
.dot:nth-child(3){ animation-delay: .3s }
@keyframes blink { 0%{opacity:.15}50%{opacity:1}100%{opacity:.15} }
</style>
</head>
<body>

<div id="chat"></div>
<div id="inputArea">
<input type="text" id="inp" placeholder="Ù¾ÛŒØ§Ù…ØªÙˆ Ø¨Ù†ÙˆÛŒØ³ Ùˆ Enter Ø¨Ø²Ù†">
<button id="send">Ø§Ø±Ø³Ø§Ù„</button>
</div>

<script>
const API_KEY = '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';
const chat = document.getElementById('chat');
const inp = document.getElementById('inp');

function addMsg(txt,cls,typing=false){
  const d=document.createElement('div');
  d.className='msg '+cls;
  chat.appendChild(d);
  chat.scrollTop=chat.scrollHeight;
  if(!typing){ d.innerText=txt; d.classList.add('show'); return; }
  let i=0;
  const showNext=()=>{i++; d.innerText=txt.slice(0,i); if(!d.classList.contains('show')) d.classList.add('show'); chat.scrollTop=chat.scrollHeight; if(i<txt.length)setTimeout(showNext,18);}
  showNext();
}

function showTypingIndicator(){
  const t=document.createElement('div');
  t.className='msg bot typing';
  t.innerHTML='<div class="dot"></div><div class="dot"></div><div class="dot"></div>';
  chat.appendChild(t); chat.scrollTop=chat.scrollHeight;
  return t;
}

async function sendMsg(){
  const val = inp.value.trim(); if(!val) return;
  addMsg(val,'user'); inp.value='';
  const typingNode = showTypingIndicator();
  try{
    const res = await fetch('https://api.openai.com/v1/chat/completions',{
      method:'POST',
      headers:{
        'Content-Type':'application/json',
        'Authorization':'Bearer '+API_KEY
      },
      body: JSON.stringify({
        model:'gpt-3.5-turbo',
        messages:[{role:'user',content:val}],
        max_tokens:700,
        temperature:0.3
      })
    });
    const data = await res.json();
    const answer = (data.choices && data.choices[0].message.content)?data.choices[0].message.content:'âš ï¸ Ù¾Ø§Ø³Ø® Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª';
    if(typingNode && typingNode.parentNode) typingNode.parentNode.removeChild(typingNode);
    addMsg(answer,'bot',true);
  }catch(e){
    if(typingNode && typingNode.parentNode) typingNode.parentNode.removeChild(typingNode);
    addMsg('âš ï¸ Ù…Ø´Ú©Ù„ Ø´Ø¨Ú©Ù‡ ÛŒØ§ API','bot');
  }
}

document.getElementById('send').onclick=sendMsg;
inp.addEventListener('keydown',e=>{ if(e.key==='Enter') sendMsg(); });

addMsg('Ø³Ù„Ø§Ù…! Ù…Ù† Coliber Ù‡Ø³ØªÙ… ðŸŒŸ Ø¢Ù…Ø§Ø¯Ù‡ Ù¾Ø§Ø³Ø®Ú¯ÙˆÛŒÛŒ','bot');
</script>

</body>
</html>
